<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap demo</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<header>
  <b style="font-size: 1.5em;">FG Finanças</b> // <a href="#">Calculadora de Gastos</a> // <a href="/calcimposto.html">Calculadora de Impostos</a> // <a href="https://www.gov.br/pf/pt-br">Como Burlar a Receita Federal</a>
</header>

<body class="dark-mode">
  <div id="start">
    <h1>Calculadora de Gastos</h1>
    <div id="sidebar">
      <aside>
        <div id="sidebar-start">
          Calculadora de Gastos
        </div>
        <div id="sidebar-random">
          Texto2
        </div>
        <div id="sidebar-end">
          Renda: R$<b id='income'>12345678.90</b><br>
          Despesas: R$<b id="spendingst">123.456.789,00</b> <br>
          Total: R$<b id="finals">0</b>
        </div>
      </aside>
    </div>
    <div id="income" class="cat"> 
      <div class="cat-start" style="background-color: rgb(12, 177, 0);">
        RENDA MENSAL
      </div>
      <div class="cat-input">
        Renda Fixa <input type="number" name="" id="">
      </div>
      <div class="cat-end">
        Total: R$0000000
      </div>
    </div>
    <div id="cats">
      <div id="casa" class="cat">
        <div class="cat-start" style="background-color: rgb(191, 0, 0);">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Unofficial_JavaScript_logo_2.svg/640px-Unofficial_JavaScript_logo_2.svg.png" alt="" width="5%">
          CASA
        </div>
        <div class="cat-input">
          Aluguel
          <input type="number">
        </div>
        <div class="cat-end">
          Total: R$12421874892374823
        </div>
      </div>
      <div id="alimentacao" class="cat">
        <div class="cat-start" style="background-color: rgb(0, 107, 213);">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Unofficial_JavaScript_logo_2.svg/640px-Unofficial_JavaScript_logo_2.svg.png" alt="" width="5%">
          Alimentação
        </div>
        <div class="cat-input">
          Aluguel
          <input type="number">
        </div>
        <div class="cat-input">
          Aluguel
          <input type="number">
        </div>
        <div class="cat-end">
          Total: R$12421874892374823
        </div>
      </div>
      <div id="imposto" class="cat">
        <div class="cat-start" style="background-color: rgb(76, 0, 191);">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Unofficial_JavaScript_logo_2.svg/640px-Unofficial_JavaScript_logo_2.svg.png" alt="" width="5%">
          Impostron
        </div>
        <div class="cat-input">
          IPTU
          <input type="number">
        </div>
        <div class="cat-input">
          IPVA
          <input type="number">
        </div>
        <div class="cat-input">
          Renda
          <input type="number">
        </div>
        <div class="cat-end">
          Total: R$12421874892374823
        </div>
      </div>
    </div>
  </div>
</body>

<script>
  let valuesl = {
    "income": [0,0,0,0],
    "casa": [0,0,0,0],
    "alimentacao": [0,0,0,0],
    "imposto": [0,0,0,0]
  }
  let finalvalue = 0
  let incomium = 0
  let set = 0
  for(let i=0; i < $('.cat-input').length; i++){
    document.getElementsByClassName('cat-input')[i].setAttribute('identifier', i)
    document.getElementsByClassName('cat-input')[i].childNodes[1].addEventListener('input', updateVals)
  }
  function updateVals(val){
    let value = val.currentTarget.value
    value = value.replace(",", "")
    if(Number.isNaN(value) || value == ""){
      console.log("Not a Number, swapping to zilch.")
      valuesl[val.currentTarget.parentElement.parentElement.getAttribute("id")][val.currentTarget.parentElement.getAttribute('identifier')] = 0
    }
    else{
      valuesl[val.currentTarget.parentElement.parentElement.getAttribute("id")][val.currentTarget.parentElement.getAttribute('identifier')] = parseFloat(value)
    }
    finalvalue = 0
    for(let i=0; i < $('.cat').length; i++){
      let ttotal = 0
      for(const kid of document.getElementsByClassName('cat')[i].children){
        for(const e of kid.querySelectorAll('input')){
          if(isNaN(e.value) || e.value <= 0){
            ttotal += 0;
          }
          else{
            ttotal += parseFloat(e.value)
          }
        }
      }
      document.getElementsByClassName('cat')[i].querySelector('.cat-end').innerHTML = `Total: R$${ttotal.toLocaleString('br', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`
    }
    if(val.currentTarget.parentElement.parentElement.getAttribute("id") == "income"){
      for(let i=0; i < valuesl["income"].length; i++){
        incomium = incomium + valuesl["income"][i]
        document.getElementById('income').innerHTML = incomium
      }
   }
   else{
    for(let i=0; i < valuesl.length; i++){
      if(valuesl[i] == "income"){
        console.log('nah')
        return
      }else{
        for(let x=0; i < valuesl[i].length; x++){
        finalvalue = finalvalue + valuesl[i][x]
        document.getElementById('spendingst').innerHTML = 'AAAAAAAAA'
        }
      }
    }
   }
    document.getElementById('finals').innerHTML = Math.floor((parseFloat(document.getElementById('income').innerHTML) - finalvalue)*100)/100
    if(parseFloat(document.getElementById('finals').innerHTML) < 0){
      document.getElementById('finals').style.color = 'rgb(255,0,0)'
    }
    else{
      document.getElementById('finals').style.color = 'aliceblue'
    }
  }
</script>

</html>